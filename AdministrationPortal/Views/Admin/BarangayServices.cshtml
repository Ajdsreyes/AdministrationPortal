@model List<AdministrationPortal.Models.ViewModels.ServiceVM>
@{
    ViewData["Title"] = "Barangay Services";
}

<div class="page-header">
    <h2>Barangay Services</h2>
    <a asp-action="AddService" class="btn-primary">+ Add Service</a>
</div>

<div class="services-grid">
    @foreach (var s in Model)
    {
        <div class="service-card big-card">

            <div class="service-header">
                <div class="service-icon">
                    <i class="bi @s.Icon"></i>
                </div>

                <span class="service-status badge @(s.IsEnabled ? "badge-active" : "badge-disabled")">
                    @(s.IsEnabled ? "Enabled" : "Disabled")
                </span>
            </div>

            <h4>@s.ServiceName</h4>

            <div class="service-stats">
                <span>Pending: <b>@s.Pending</b></span>
                <span>Approved: <b>@s.Approved</b></span>
                <span>Ready: <b>@s.Ready</b></span>
            </div>

            <div class="service-actions">

                <i class="bi bi-eye action-icon"
                   title="View Requests"
                   onclick="location.href='@Url.Action(
                                                               "ServiceRequests",
                                                               "Admin",
                                                               new { serviceId = s.ServiceId }
                                                          )'">
            </i>

                @* Changed s.Id to s.ServiceId to match SQL script Primary Key *@
                <a asp-action="EditServiceRequirements"
                   asp-route-id="@s.ServiceId"
                   title="Edit Requirements">
                    <i class="bi bi-sliders"></i>
                </a>

                @* Changed s.Id to s.ServiceId to match AdminController toggle logic *@
                <form asp-action="ToggleService"
                      asp-controller="Admin"
                      asp-route-id="@s.ServiceId"
                      method="post"
                      class="toggle-form">

                    <label class="switch">
                        <input type="checkbox"
                               onchange="this.form.submit()"
                               @(s.IsEnabled ? "checked" : "") />
                        <span class="slider"></span>
                    </label>
                </form>

            </div>

        </div>
        }
</div>